(()=>{"use strict";const e=window.wp.blocks,t=window.React,l=window.wp.element,a=window.wp.blockEditor,n=window.wp.components,o=window.wp.i18n,r=({attributes:e,setAttributes:l})=>{const{alt:r,renderer:i="svg"}=e;return(0,t.createElement)(a.InspectorAdvancedControls,null,(0,t.createElement)(n.SelectControl,{label:(0,o.__)("Renderer"),value:i,onChange:e=>l({renderer:e}),options:[{value:"svg",label:"SVG"},{value:"canvas",label:"Canvas"}]}),(0,t.createElement)(n.TextareaControl,{label:(0,o.__)("Description","am-lottieplayer"),help:(0,o.__)("Describe the animation. This is helpful for screen readers and search engines.","am-lottieplayer"),value:r,onChange:e=>l({alt:e})}))};let i=function(e){return e.Bounce="bounce",e.Normal="normal",e}({}),s=function(e){return e.Void="void",e.Stop="stop",e.Pause="pause",e.Reverse="reverse",e}({});const c=window.wp.blob,u=({id:e="",onChange:l,subTitle:a,title:o,value:r})=>(0,t.createElement)(n.BaseControl,{id:e,help:a,className:"lottie-switch-label"},(0,t.createElement)(n.BaseControl.VisualLabel,null,o),(0,t.createElement)(n.FormToggle,{checked:r,onChange:()=>l(!r)})),m=({id:e="",onChange:l,title:a,value:o="",disabled:r,placeholder:i=""})=>(0,t.createElement)(n.BaseControl,{id:e,help:a,className:"lottie-number-wrapper"},(0,t.createElement)(n.TextControl,{value:o,onChange:e=>{l(void 0===e||""===e?void 0:Number(e))},onKeyDown:e=>{(({ctrlKey:e,key:t,metaKey:l,shiftKey:a})=>!(!a&&"End"!==t&&"Home"!==t&&"Backspace"!==t&&"Tab"!==t&&"Enter"!==t&&"Delete"!==t&&(!e&&!l||"a"!==t&&"c"!==t&&"v"!==t&&"x"!==t&&"z"!==t&&"t"!==t&&"r"!==t)))(e)||!(({key:e})=>Number(e)>=0&&Number(e)<=9)(e)&&e.preventDefault()},disabled:r,placeholder:i})),d=({id:e="",onChange:l,title:a,help:o,value:r="",placeholder:i=""})=>(0,t.createElement)(n.BaseControl,{id:e,help:o,className:"lottie-number-wrapper"},(0,t.createElement)(n.BaseControl.VisualLabel,null,a),(0,t.createElement)(n.TextControl,{value:r,onChange:e=>l(e),placeholder:i})),p=({attributes:e,clientId:a,setAttributes:r})=>{const{autoplay:s,controls:c,direction:d,loop:p,mode:y=i.Normal,segment:b,speed:g=1,subframe:h}=e,[v,f]=(0,l.useState)(0);return(0,l.useEffect)((()=>{const e=document.getElementById(a);e&&f(e?.getLottie()?.totalFrames)}),[a]),(0,t.createElement)(n.Panel,null,(0,t.createElement)(n.PanelBody,{title:(0,o.__)("Animation Settings","am-lottieplayer"),initialOpen:!0},(0,t.createElement)(u,{id:"am-lottieplayer-controls-settings",title:(0,o.__)("Show controls","am-lottieplayer"),value:!!c,onChange:e=>r({controls:e})}),(0,t.createElement)(u,{id:"am-lottieplayer-autoplay-settings",title:(0,o.__)("Autoplay","am-lottieplayer"),value:!!s,onChange:e=>{r({autoplay:e})}}),(0,t.createElement)(u,{id:"am-lottieplayer-loop-settings",title:(0,o.__)("Loop","am-lottieplayer"),value:!!p,onChange:e=>{r({loop:e})}}),(0,t.createElement)(u,{id:"am-lottieplayer-playmode-settings",title:(0,o.__)("Boomerang","am-lottieplayer"),value:y===i.Bounce,onChange:e=>{r({mode:e?i.Bounce:i.Normal})}}),(0,t.createElement)(u,{id:"am-lottieplayer-reverse-settings",title:(0,o.__)("Reverse","am-lottieplayer"),value:-1===d,onChange:e=>r({direction:e?-1:1})}),(0,t.createElement)(u,{id:"am-lottieplayer-subframe-settings",title:(0,o.__)("Subframe","am-lottieplayer"),subTitle:(0,o.__)("Enabling this can sometimes reduce flicker","am-lottieplayer"),value:!!h,onChange:e=>r({subframe:e})}),(0,t.createElement)(n.RangeControl,{label:(0,o.__)("Speed","am-lottieplayer"),min:.5,max:5,step:.5,value:g,onChange:e=>r({speed:e})}),(0,t.createElement)(n.BaseControl.VisualLabel,null,(0,o.__)("Play only part of the animation","am-lottieplayer")),(0,t.createElement)(n.PanelRow,{className:"lottie-segment"},(0,t.createElement)(m,{id:"am-lottieplayer-segment-in",title:(0,o.__)("First frame","am-lottieplayer"),value:b?.[0],onChange:e=>{var t;return r({segment:void 0!==e?[e,null!==(t=b?.[1])&&void 0!==t?t:1]:void 0})},placeholder:"1"}),(0,t.createElement)(m,{id:"am-lottieplayer-segment-out",title:(0,o.__)("Last frame","am-lottieplayer"),value:b?.[1],onChange:e=>{var t;return r({segment:e?[null!==(t=b?.[0])&&void 0!==t?t:1,e<=Number(v)+1?e:Number(v)+1]:void 0})},placeholder:(Number(v)+1).toString()}))))},y=({attributes:e,setAttributes:l})=>{const{background:a}=e;return(0,t.createElement)(n.Panel,null,(0,t.createElement)(n.PanelBody,{title:(0,o.__)("Background Color","am-lottieplayer"),initialOpen:!1},(0,t.createElement)(n.ColorPicker,{color:a,onChangeComplete:e=>l({background:e.hex})})))},b=({attributes:e,setAttributes:l})=>{const{clickEvent:a,hover:r,mouseout:i,once:c,scrollEvent:m,scrollDelay:p,selector:y}=e;return(0,t.createElement)(n.Panel,null,(0,t.createElement)(n.PanelBody,{title:(0,o.__)("Interactions","am-lottieplayer"),initialOpen:!0},(0,t.createElement)(u,{id:"am-lottieplayer-click-settings",title:(0,o.__)("Play on click","am-lottieplayer"),value:a,onChange:e=>l({clickEvent:e})}),(0,t.createElement)(u,{id:"am-lottieplayer-hover-settings",title:(0,o.__)("Play on mouseover","am-lottieplayer"),value:r,onChange:e=>l({hover:e})}),r&&(0,t.createElement)(n.SelectControl,{label:(0,o.__)("On mouseout","am-lottieplayer"),value:i,onChange:e=>l({mouseout:e}),options:[{value:s.Void,label:(0,o.__)("No event","am-lottieplayer")},{value:s.Stop,label:(0,o.__)("Stop","am-lottieplayer")},{value:s.Pause,label:(0,o.__)("Pause","am-lottieplayer")},{value:s.Reverse,label:(0,o.__)("Reverse","am-lottieplayer")}]}),(r||a)&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(d,{id:"am-lottieplayer-settings",title:(0,o.__)("Trigger element","am-lottieplayer"),help:(0,o.__)("Anchor tag (id) for an element you want to trigger the animation, either by hover or click.","am-lottieplayer"),placeholder:"#",value:y?.id,onChange:e=>l({selector:{...y,id:e}})}),(0,t.createElement)(u,{id:"am-lottieplayer-selector-settings",title:(0,o.__)("Apply interaction only to trigger element","am-lottieplayer"),value:y?.exclude,onChange:e=>l({selector:{...y,exclude:e}})})),(0,t.createElement)(u,{id:"am-lottieplayer-scroll-settings",title:(0,o.__)("Play on scroll, when visible in viewport","am-lottieplayer"),value:m,onChange:e=>l({scrollEvent:e})}),m&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(u,{id:"am-lottieplayer-once-settings",title:(0,o.__)("Play only once","am-lottieplayer"),value:c,onChange:e=>l({once:e})}),(0,t.createElement)(n.RangeControl,{label:(0,o.__)("Delay, in 10th of a second","am-lottieplayer"),min:0,max:50,step:1,value:null!=p?p:1,onChange:e=>l({scrollDelay:e})}))))},g=({attributes:e,setAttributes:a})=>{const{align:r,fullscreen:i,height:s,objectFit:c="contain",width:d}=e,p=(0,l.useCallback)((e=>"full"===r||"wide"===r?"100%":e&&"0"!==e?e:void 0),[r]);return(0,t.createElement)(n.Panel,null,(0,t.createElement)(n.PanelBody,{title:(0,o.__)("Dimensions","am-lottieplayer"),initialOpen:!0},(!i||"full"!==r)&&(0,t.createElement)(n.PanelRow,{className:"lottie-dimensions"},(0,t.createElement)(m,{id:"am-lottieplayer-width-settings",title:(0,o.__)("Width","am-lottieplayer"),value:p(d),onChange:e=>a({width:null!=e?e:null}),disabled:"full"===r||"wide"===r,placeholder:"full"===r||"wide"===r?"100%":"auto"}),(0,t.createElement)(m,{id:"am-lottieplayer-height-settings",title:(0,o.__)("Height","am-lottieplayer"),value:s&&"0"!==s.toString()?s:void 0,disabled:i,onChange:e=>a({height:e}),placeholder:"auto"})),("full"===r||"wide"===r)&&(0,t.createElement)(u,{id:"am-lottieplayer-fullscreen-settings",title:(0,o.__)("Fill screen","am-lottieplayer"),value:i,onChange:e=>a({fullscreen:e})}),(0,t.createElement)(n.SelectControl,{label:(0,o.__)("Object fit"),value:c,onChange:e=>{a({objectFit:e})},options:[{value:"contain",label:(0,o.__)("Contain","am-lottieplayer")},{value:"cover",label:(0,o.__)("Cover","am-lottieplayer")},{value:"fill",label:(0,o.__)("Fill","am-lottieplayer")},{value:"none",label:(0,o.__)("None","am-lottieplayer")}]})))};function h({attributes:e,className:l,clientId:n,context:o,isSelected:i,setAttributes:s}){return(0,t.createElement)(a.InspectorControls,null,(0,t.createElement)(p,{attributes:e,setAttributes:s,clientId:n,isSelected:i,context:o,className:l}),(0,t.createElement)(b,{attributes:e,setAttributes:s,clientId:n,isSelected:i,context:o,className:l}),(0,t.createElement)(g,{attributes:e,setAttributes:s,clientId:n,isSelected:i,context:o,className:l}),(0,t.createElement)(y,{attributes:e,setAttributes:s,clientId:n,isSelected:i,context:o,className:l}),(0,t.createElement)(r,{attributes:e,setAttributes:s,clientId:n,isSelected:i,context:o,className:l}))}function v(){return(0,t.createElement)(n.SVG,{role:"img",xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",viewBox:"0 0 80 80"},(0,t.createElement)("style",null,"\n\t\t\t\t.am-lottieplayer-path {\n\t\t\t\t\tfill: url(#a)\n\t\t\t\t}\n\t\t\t\t.block-editor-block-toolbar .am-lottieplayer-path,\n\t\t\t\t.components-panel .am-lottieplayer-path {\n\t\t\t\t\tfill: var(--wp-admin-theme-color-darker-10)\n\t\t\t\t}"),(0,t.createElement)("defs",null,(0,t.createElement)("radialGradient",{id:"a",cx:".2",cy:"1.07",r:"1.2"},(0,t.createElement)("stop",{offset:"10%"},(0,t.createElement)("animate",{attributeName:"stop-color",values:"#24708f;#e18d4c;#1f374c;#85c6e0;#24708f;",dur:"12s",repeatCount:"indefinite"})),(0,t.createElement)("stop",{offset:"90%"},(0,t.createElement)("animate",{attributeName:"stop-color",values:"#85c6e0;#24708f;#e18d4c;#1f374c;#85c6e0;",dur:"24s",repeatCount:"indefinite"})))),(0,t.createElement)(n.Path,{className:"am-lottieplayer-path",d:"M60 0H20C9 0 0 9 0 20v39.5C0 71 9 80 20 80h39.5c11 0 20.5-9 20.5-20V20C80 9 71 0 60 0zm4.9 59.7h-7.4V37.1c0-3.2.3-8.2.3-8.2h-.1s-.9 4.7-1.7 7.5l-6.8 23.3h-4l-11-30.2c-.8-2.2-2-5.8-2-5.8h-.1s-1.1 3.4-1.9 5.8L18.7 59.7H15l15-39.4h4.2l11.4 30c.3-1.4 1.2-6.1 2.4-10.2l5.6-19.8H65v39.4z"}))}function f({children:e,onSelectMedia:n,onError:r}){const[i,s]=(0,l.useState)(!1);return(0,t.createElement)(a.MediaPlaceholder,{icon:(0,t.createElement)(a.BlockIcon,{icon:v}),labels:{title:(0,o.__)("AM Lottie Animation","am-lottieplayer"),instructions:i?(0,o.__)("Dropped!","am-lottieplayer"):(0,o.__)("Upload Lottie animations to WordPress and add them in Gutenberg.","am-lottieplayer")},onHTMLDrop:()=>s(!0),onSelect:n,accept:".lottie, .json",allowedTypes:["application/json","application/zip"],onError:r},e)}const E=window.wp.data;function _({attributes:e,clientId:a}){const{align:n,alt:o,autoplay:r,background:i,controls:s,direction:c,height:u,loop:m,mode:d,objectFit:p,renderer:y,segment:b,speed:g,src:h,subframe:v,width:f}=e,{getBlockIndex:_}=(0,E.useSelect)((e=>e("core/block-editor")),[]),C=_(a),w=(0,l.useRef)(null),S=(0,l.useRef)(!0),k=b&&b?.[1]?JSON.stringify([b[0],b[1]]):void 0,N=(0,l.useCallback)((()=>{w.current&&(w.current.reload&&w.current.reload(),setTimeout((()=>{const e=w.current?.shadowRoot?.querySelector("canvas");"svg"===y&&e?.remove()}),100))}),[y]),P=e=>{if(e&&"number"==typeof e)return`${e}px`};return(0,l.useEffect)((()=>{S.current||N(),S.current=!1}),[r,C,c,m,d,p,N,y,b,g,v]),(0,t.createElement)("dotlottie-player",{id:a,class:"lottie-element",autoplay:r?"":null,controls:s?"":null,description:o,direction:c,loop:m?"":null,mode:d,objectfit:p,ref:w,renderer:y,segment:k,speed:g,subframe:v?"":null,src:h,style:{width:(x=f,"wide"===n||"full"===n?"100%":P(x)),height:P(u),backgroundColor:i,margin:"0 auto"}});var x}function C({attributes:e,clientId:l,isPlaceholder:a,setAttributes:o}){return(0,t.createElement)(t.Fragment,null,a?(0,t.createElement)(f,{onSelectMedia:({id:e,url:t,alt:l})=>{if(!t)return o({src:void 0,id:void 0});o({src:t,id:e?.toString(),alt:l})},onError:e=>{(e=>{(0,t.createElement)(n.Notice,{status:"error"},e)})(e)},children:void 0}):(0,t.createElement)(_,{attributes:e,clientId:l}))}const w=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"gb/lottieplayer","title":"AM LottiePlayer","description":"Play Lottie animations on your WordPress website.","keywords":["animation","gif","motion","vector","SVG","Lottie","dotLottie"],"category":"media","supports":{"align":true,"anchor":true,"html":false},"textdomain":"am-lottieplayer","attributes":{"align":{"enum":["none","left","right","center"],"default":"none"},"alt":{"type":"string","default":""},"autoplay":{"type":"boolean"},"background":{"type":"string","default":"transparent"},"controls":{"type":"boolean","default":true},"clickEvent":{"type":"boolean","default":false},"direction":{"type":"number","default":1},"height":{"type":"number","default":null},"hover":{"type":"boolean","default":false},"id":{"type":"string"},"loop":{"type":"boolean"},"mode":{"enum":["bounce","normal"],"default":"normal"},"mouseout":{"type":"string","default":"stop"},"objectFit":{"type":"string","default":"contain"},"once":{"type":"boolean","default":false},"renderer":{"enum":["svg","canvas","html"],"default":"svg"},"scrollEvent":{"type":"boolean","default":false},"scrollDelay":{"type":"number","default":null},"segment":{"type":"array","default":null},"selector":{"type":"object","default":{"id":null,"exclude":false}},"speed":{"type":"number","default":1},"src":{"type":"string","default":""},"subframe":{"type":"boolean","default":true},"width":{"type":"number","default":null}},"editorScript":"file:./index.js","editorStyle":"file:./index.css"}');(0,e.registerBlockType)(w,{icon:v,edit:function({attributes:e,className:o,clientId:r,context:i,isSelected:s,setAttributes:u}){const{id:m,src:d}=e,[p,y]=(0,l.useState)(!0),b=((e,t)=>!e&&(0,c.isBlobURL)(t))(m,d);return(0,l.useEffect)((()=>{y(!d||""===d)}),[d]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(h,{attributes:e,setAttributes:u,clientId:r,isSelected:s,context:i,className:o}),b&&(0,t.createElement)(n.Spinner,null),(0,t.createElement)("div",{...(0,a.useBlockProps)()},(0,t.createElement)(C,{attributes:e,setAttributes:u,isPlaceholder:p,clientId:r,isSelected:s,context:i,className:o})))},save:function({attributes:e}){const{align:l,alt:n,autoplay:o,background:r,controls:i,clickEvent:s,direction:c,height:u,hover:m,id:d,loop:p,mode:y,mouseout:b,objectFit:g,once:h,renderer:v,scrollEvent:f,scrollDelay:E,segment:_,selector:C,speed:w,src:S,subframe:k,width:N}=e,P=JSON.stringify(C),x=_&&_?.[1]?JSON.stringify([_[0],_[1]]):void 0;return(0,t.createElement)("figure",{id:d,...a.useBlockProps.save({className:`align${null!=l?l:"none"}`}),style:{backgroundColor:r,height:u&&0!==u?u:"auto",width:N&&0!==N?N:"auto",margin:"0 auto"}},(0,t.createElement)("dotlottie-player",{class:"lottie-element"+(C?.id?" has-selector":""),autoplay:o?"":null,controls:i?"":null,description:n,direction:c,"data-direction":c,"data-mouseover":m,"data-mouseout":b,"data-click":s,"data-scroll":f,"data-delay":E,"data-selector":P,"data-once":h,loop:p?"":null,mode:y,objectfit:g,renderer:v,segment:x,src:S,speed:w,subframe:k?"":null}))}})})();