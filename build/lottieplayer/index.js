(()=>{"use strict";const e=window.wp.blocks,t=window.wp.i18n,l=window.wp.element,n=window.wp.blockEditor,o=window.wp.components,a=function(){let{attributes:e={},setAttributes:a=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{direction:r,interactivityType:i,mode:c,renderer:s,speed:u}=e;return(0,l.createElement)(n.InspectorAdvancedControls,{key:"inspector"},(0,l.createElement)(o.SelectControl,{label:(0,t.__)("Renderer"),value:s,onChange:e=>a({renderer:e}),options:[{value:"svg",label:(0,t.__)("SVG")},{value:"canvas",label:(0,t.__)("Canvas")}]}),(0,l.createElement)(o.SelectControl,{label:(0,t.__)("Play animation on"),value:i,onChange:e=>{a({interactivityType:e,autoplay:"none"===e})},options:[{value:"none",label:(0,t.__)("Page Load")},{value:"hold",label:(0,t.__)("Hover")},{value:"click",label:(0,t.__)("Click")},{value:"scroll",label:(0,t.__)("Scroll")}]}),(0,l.createElement)(o.RangeControl,{label:(0,t.__)("Speed"),min:.5,max:5,step:.5,value:u,onChange:e=>a({speed:e})}),(0,l.createElement)(o.SelectControl,{label:(0,t.__)("Play mode"),value:c,name:"mode",onChange:e=>a({mode:e}),options:[{value:"normal",label:"Normal"},{value:"bounce",label:"Bounce"}]}),(0,l.createElement)(o.SelectControl,{label:(0,t.__)("Direction"),value:r,onChange:e=>a({direction:e}),options:[{value:"1",label:(0,t.__)("Forward")},{value:"-1",label:(0,t.__)("Backward")}]}))},r=e=>{switch(e){case"contain":default:return"xMidYMid meet";case"cover":return"xMidYMid slice";case"fill":return"none";case"none":return"xMinYMin slice"}},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return l=>{l&&l.url?e({dimRatio:100===t?50:t,src:l.url,id:l.id,alt:l?.alt}):e({src:void 0,id:void 0})}},c=e=>{let{ctrlKey:t,key:l,metaKey:n,shiftKey:o}=e;return o||"End"===l||"Home"===l||"Backspace"===l||"Tab"===l||"Enter"===l||"Delete"===l||(t||n)&&("a"===l||"c"===l||"v"===l||"x"===l||"z"===l||"t"===l||"r"===l)},s=e=>{let{key:t}=e;return t>=0&&t<=9},u=function(){let{onChange:e=(()=>{}),subTitle:t="",title:n="",value:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.createElement)(o.BaseControl,{help:t,className:"lottie-switch-label"},(0,l.createElement)(o.BaseControl.VisualLabel,null,n),(0,l.createElement)(o.FormToggle,{checked:a,onChange:()=>e(!a)}))},d=function(){let{onChange:e=(()=>{}),title:t="",value:n=null,disabled:a=!1,placeholder:r=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=e=>{c(e)||!s(e)&&e.preventDefault()};return(0,l.createElement)(o.BaseControl,{help:t,className:"lottie-number-wrapper"},(0,l.createElement)(o.TextControl,{value:n,onChange:t=>e(Number(t)),onKeyDown:i,disabled:a,placeholder:r}))},p=function(){let{attributes:e={},setAttributes:n=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{align:a,controls:r,height:i,loop:c,objectFit:s,width:p}=e,m=(0,l.useCallback)((e=>"full"===a||"wide"===a?"100%":e&&"0"!==e?e:null),[a]);return(0,l.createElement)(o.Panel,null,(0,l.createElement)(o.PanelBody,{title:(0,t.__)("Animation Settings"),initialOpen:!0},(0,l.createElement)(u,{title:(0,t.__)("Loop"),subTitle:(0,t.__)("Repeat animation"),value:c,onChange:e=>{n({loop:e})}}),(0,l.createElement)(u,{title:(0,t.__)("Controls"),subTitle:(0,t.__)("Display animation controls"),value:r,onChange:e=>{n({controls:e})}}),(0,l.createElement)(o.PanelRow,{className:"lottie-dimensions"},(0,l.createElement)(d,{title:(0,t.__)("Width"),value:m(p),onChange:e=>{n({width:null!=e?e:null})},disabled:"full"===a||"wide"===a,placeholder:"full"===a||"wide"===a?"100%":"auto"}),(0,l.createElement)(d,{title:(0,t.__)("Height"),value:i&&"0"!==i?i:null,onChange:e=>{n({height:null!=e?e:null})},placeholder:"auto"})),(0,l.createElement)(o.SelectControl,{label:(0,t.__)("Object fit"),value:s,onChange:e=>{n({objectFit:e})},options:[{value:"contain",label:(0,t.__)("Contain")},{value:"cover",label:(0,t.__)("Cover")},{value:"fill",label:(0,t.__)("Fill")},{value:"none",label:(0,t.__)("None")}]})))},m=function(){let{attributes:e={},setAttributes:n=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{background:a}=e;return(0,l.createElement)(o.Panel,null,(0,l.createElement)(o.PanelBody,{title:(0,t.__)("Background Color"),initialOpen:!1},(0,l.createElement)(o.ColorPicker,{color:a,onChange:e=>{n({background:e})},enableAlpha:!0})))};function b(){let{attributes:e={},setAttributes:t=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.createElement)(n.InspectorControls,null,(0,l.createElement)(p,{attributes:e,setAttributes:t}),(0,l.createElement)(m,{attributes:e,setAttributes:t}),(0,l.createElement)(a,{attributes:e,setAttributes:t}))}const h=window.wp.data,g=window.wp.notices;function f(){return(0,l.createElement)(o.SVG,{role:"img",xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",viewBox:"0 0 80 80"},(0,l.createElement)("style",null,"\n\t\t\t\t.am-lottieplayer-path {\n\t\t\t\t\tfill: url(#a)\n\t\t\t\t}\n\t\t\t\t.block-editor-block-toolbar .am-lottieplayer-path,\n\t\t\t\t.components-panel .am-lottieplayer-path {\n\t\t\t\t\tfill: var(--wp-admin-theme-color-darker-10)\n\t\t\t\t}"),(0,l.createElement)("defs",null,(0,l.createElement)("radialGradient",{id:"a",cx:".2",cy:"1.07",r:"1.2"},(0,l.createElement)("stop",{offset:"0%",stopColor:"#92003b"}),(0,l.createElement)("stop",{offset:"5%",stopColor:"#ff4a9e"}),(0,l.createElement)("stop",{offset:"45%",stopColor:"#24708f"}),(0,l.createElement)("stop",{offset:"60%",stopColor:"#24708f"}),(0,l.createElement)("stop",{offset:"90%",stopColor:"#00c1a2"}))),(0,l.createElement)(o.Path,{className:"am-lottieplayer-path",d:"M60 0H20C9 0 0 9 0 20v39.5C0 71 9 80 20 80h39.5c11 0 20.5-9 20.5-20V20C80 9 71 0 60 0zm4.9 59.7h-7.4V37.1c0-3.2.3-8.2.3-8.2h-.1s-.9 4.7-1.7 7.5l-6.8 23.3h-4l-11-30.2c-.8-2.2-2-5.8-2-5.8h-.1s-1.1 3.4-1.9 5.8L18.7 59.7H15l15-39.4h4.2l11.4 30c.3-1.4 1.2-6.1 2.4-10.2l5.6-19.8H65v39.4z"}))}function v(){let{children:e,onSelectMedia:o=(()=>{}),onError:a=(()=>{}),disableMediaButtons:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.createElement)(n.MediaPlaceholder,{icon:(0,l.createElement)(n.BlockIcon,{icon:f}),labels:{title:(0,t.__)("AM Lottie Animation"),instructions:(0,t.__)("Upload Lottie animations to WordPress and add them in Gutenberg.")},onSelect:o,accept:".lottie, .json",allowedTypes:["application/json","application/zip","text/plain"],onError:a,disableMediaButtons:r},e)}function _(){let{attributes:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{align:t,alt:n,autoplay:o,background:a,controls:i,direction:c,height:s,loop:u,mode:d,objectFit:p,renderer:m,speed:b,src:h,width:g}=e,f=(0,l.useRef)(null),v=(0,l.useRef)(!0),_=(0,l.useCallback)((()=>{f.current.reload(),setTimeout((()=>{const e=f?.current?.shadowRoot?.querySelector("canvas");"svg"===m&&e&&e.remove()}),100)}),[m]),y=(0,l.useCallback)((e=>"wide"===t||"full"===t?"100%":e&&"number"==typeof e?`${e}px`:null),[t]);return(0,l.useEffect)((()=>{v.current||_(),v.current=!1}),[p,_,m,b]),(0,l.useEffect)((()=>{f.current&&u&&o&&"playing"!==f.current.currentState&&f.current.play()}),[o,u]),(0,l.createElement)("dotlottie-player",{class:"lottie-element",autoplay:o?"":null,controls:i?"":null,description:n,direction:c,loop:u?"":null,mode:d,preserveAspectRatio:r(p),ref:f,renderer:m,speed:b,src:h,style:{width:y(g),height:s&&"number"==typeof s?`${s}px`:null,backgroundColor:a}})}function y(){let{attributes:e={},setAttributes:t=(()=>{}),isPlaceholder:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createErrorNotice:o}=(0,h.useDispatch)(g.store),a=e=>{o(e,{type:"snackbar"})},r=i(t);return(0,l.createElement)(l.Fragment,null,n?(0,l.createElement)(v,{onSelectMedia:r,onError:a,disableMediaButtons:!n}):(0,l.createElement)(_,{attributes:e}))}function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e},E.apply(this,arguments)}const w=JSON.parse('{"u2":"gb/lottieplayer"}');(0,e.registerBlockType)(w.u2,{icon:f,keywords:[(0,t.__)("animation"),(0,t.__)("gif"),(0,t.__)("motion"),(0,t.__)("vector")],attributes:{align:{type:"string",default:"none"},alt:{type:"string",default:(0,t.__)("AM Lottie animation")},autoplay:{type:"boolean",default:!0},background:{type:"string",default:"transparent"},controls:{type:"boolean",default:!0},direction:{type:"number",default:1},height:{type:"number",default:null},id:{type:"string",default:null},interactivityType:{type:"string",default:"none"},loop:{type:"boolean",default:!0},mode:{type:"string",default:"normal"},objectFit:{type:"string",default:"contain"},renderer:{type:"string",default:"svg"},speed:{type:"number",default:1},src:{type:"string"},width:{type:"number",default:null}},edit:function(){let{attributes:e={},setAttributes:t=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{src:o}=e,a=(0,l.useRef)(!0);return(0,l.useEffect)((()=>{a.current=!o||""===o}),[o]),(0,l.createElement)(l.Fragment,null,(0,l.createElement)(b,{attributes:e,setAttributes:t}),(0,l.createElement)("div",(0,n.useBlockProps)(),(0,l.createElement)(y,{attributes:e,setAttributes:t,isPlaceholder:a.current})))},save:function(e){let{attributes:t}=e;const{align:o,alt:a,autoplay:i,background:c,controls:s,direction:u,height:d,id:p,loop:m,mode:b,objectFit:h,src:g,width:f}=t;return(0,l.createElement)("figure",E({id:p},n.useBlockProps.save({className:`align${o}`}),{style:{backgroundColor:c,height:d&&"0"!==d?d:"auto",width:f&&"0"!==f?f:"auto"}}),(0,l.createElement)("dotlottie-player",{autoplay:i,controls:s,description:a,direction:u,loop:m,mode:b,preserveAspectRatio:r(h),src:g}))}})})();