(()=>{"use strict";const e=window.wp.blocks,t=window.wp.element,l=window.wp.blockEditor,a=window.wp.components,o=window.wp.i18n,n=e=>{let{attributes:n,setAttributes:r}=e;const{alt:i,renderer:c="svg"}=n;return(0,t.createElement)(l.InspectorAdvancedControls,null,(0,t.createElement)(a.SelectControl,{label:(0,o.__)("Renderer"),value:c,onChange:e=>r({renderer:e}),options:[{value:"svg",label:"SVG"},{value:"canvas",label:"Canvas"}]}),(0,t.createElement)(a.TextareaControl,{label:(0,o.__)("Description","am-lottieplayer"),help:(0,o.__)("Describe the animation. This is helpful for screen readers and search engines.","am-lottieplayer"),value:i,onChange:e=>r({alt:e})}))},r=window.wp.blob;let i=function(e){return e.Bounce="bounce",e.Normal="normal",e}({}),c=function(e){return e.Void="void",e.Stop="stop",e.Pause="pause",e.Reverse="reverse",e}({});const s=e=>{let{id:l="",onChange:o,subTitle:n,title:r,value:i}=e;return(0,t.createElement)(a.BaseControl,{id:l,help:n,className:"lottie-switch-label"},(0,t.createElement)(a.BaseControl.VisualLabel,null,r),(0,t.createElement)(a.FormToggle,{checked:i,onChange:()=>o(!i)}))},u=e=>{let{id:l="",onChange:o,title:n,value:r="",disabled:i,placeholder:c=""}=e;return(0,t.createElement)(a.BaseControl,{id:l,help:n,className:"lottie-number-wrapper"},(0,t.createElement)(a.TextControl,{value:r,onChange:e=>o(+e),onKeyDown:e=>{(e=>{let{ctrlKey:t,key:l,metaKey:a,shiftKey:o}=e;return o||"End"===l||"Home"===l||"Backspace"===l||"Tab"===l||"Enter"===l||"Delete"===l||(t||a)&&("a"===l||"c"===l||"v"===l||"x"===l||"z"===l||"t"===l||"r"===l)})(e)||!(e=>{let{key:t}=e;return t>=0&&t<=9})(e)&&e.preventDefault()},disabled:i,placeholder:c}))},d=e=>{let{id:l="",onChange:o,title:n,help:r,value:i="",placeholder:c=""}=e;return(0,t.createElement)(a.BaseControl,{id:l,help:r,className:"lottie-number-wrapper"},(0,t.createElement)(a.BaseControl.VisualLabel,null,n),(0,t.createElement)(a.TextControl,{value:i,onChange:e=>o(e),placeholder:c}))},m=e=>{let{attributes:l,setAttributes:n}=e;const{autoplay:r,controls:c,direction:u,loop:d,mode:m=i.Normal,speed:p=1}=l;return(0,t.createElement)(a.Panel,null,(0,t.createElement)(a.PanelBody,{title:(0,o.__)("Animation Settings","am-lottieplayer"),initialOpen:!0},(0,t.createElement)(s,{id:"am-lottieplayer-controls-settings",title:(0,o.__)("Show controls","am-lottieplayer"),value:c,onChange:e=>n({controls:e})}),(0,t.createElement)(s,{id:"am-lottieplayer-autoplay-settings",title:(0,o.__)("Autoplay","am-lottieplayer"),value:r,onChange:e=>{n({autoplay:e})}}),(0,t.createElement)(s,{id:"am-lottieplayer-loop-settings",title:(0,o.__)("Loop","am-lottieplayer"),value:d,onChange:e=>{n({loop:e}),e||m!==i.Bounce||n({mode:i.Normal})}}),d&&(0,t.createElement)(s,{id:"am-lottieplayer-playmode-settings",title:(0,o.__)("Boomerang","am-lottieplayer"),value:m===i.Bounce,onChange:e=>{n({mode:e?i.Bounce:i.Normal})}}),(0,t.createElement)(s,{id:"am-lottieplayer-reverse-settings",title:(0,o.__)("Reverse","am-lottieplayer"),value:-1===u,onChange:e=>n({direction:e?-1:1})}),(0,t.createElement)(a.RangeControl,{label:(0,o.__)("Speed","am-lottieplayer"),min:.5,max:5,step:.5,value:p,onChange:e=>n({speed:e})})))},p=e=>{let{attributes:l,setAttributes:n}=e;const{background:r}=l;return(0,t.createElement)(a.Panel,null,(0,t.createElement)(a.PanelBody,{title:(0,o.__)("Background Color","am-lottieplayer"),initialOpen:!1},(0,t.createElement)(a.ColorPicker,{color:r,onChangeComplete:e=>n({background:e.hex})})))},y=e=>{let{attributes:l,setAttributes:n}=e;const{clickEvent:r,hover:i,mouseout:u,selector:m}=l;return(0,t.createElement)(a.Panel,null,(0,t.createElement)(a.PanelBody,{title:(0,o.__)("Interactions","am-lottieplayer"),initialOpen:!0},(0,t.createElement)(s,{id:"am-lottieplayer-click-settings",title:(0,o.__)("Play on click","am-lottieplayer"),value:r,onChange:e=>n({clickEvent:e})}),(0,t.createElement)(s,{id:"am-lottieplayer-hover-settings",title:(0,o.__)("Play on mouseover","am-lottieplayer"),value:i,onChange:e=>n({hover:e})}),i&&(0,t.createElement)(a.SelectControl,{label:(0,o.__)("On mouseout","am-lottieplayer"),value:u,onChange:e=>n({mouseout:e}),options:[{value:c.Void,label:(0,o.__)("No event","am-lottieplayer")},{value:c.Stop,label:(0,o.__)("Stop","am-lottieplayer")},{value:c.Pause,label:(0,o.__)("Pause","am-lottieplayer")},{value:c.Reverse,label:(0,o.__)("Reverse","am-lottieplayer")}]}),(i||r)&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(d,{id:"am-lottieplayer-settings",title:(0,o.__)("Selector","am-lottieplayer"),help:(0,o.__)("Anchor tag (id) for an element you also want the interaction to apply to.","am-lottieplayer"),placeholder:"#",value:m?.id,onChange:e=>n({selector:{...m,id:e}})}),(0,t.createElement)(s,{id:"am-lottieplayer-selector-settings",title:(0,o.__)("Apply interaction only to selector","am-lottieplayer"),value:m?.exclude,onChange:e=>n({selector:{...m,exclude:e}})}))))},b=e=>{let{attributes:l,setAttributes:n}=e;const{align:r,fullscreen:i,height:c,objectFit:d="contain",width:m}=l,p=(0,t.useCallback)((e=>"full"===r||"wide"===r?"100%":e&&"0"!==e?e:void 0),[r]);return(0,t.createElement)(a.Panel,null,(0,t.createElement)(a.PanelBody,{title:(0,o.__)("Dimensions","am-lottieplayer"),initialOpen:!0},(!i||"full"!==r)&&(0,t.createElement)(a.PanelRow,{className:"lottie-dimensions"},(0,t.createElement)(u,{id:"am-lottieplayer-width-settings",title:(0,o.__)("Width","am-lottieplayer"),value:p(m),onChange:e=>n({width:null!=e?e:null}),disabled:"full"===r||"wide"===r,placeholder:"full"===r||"wide"===r?"100%":"auto"}),(0,t.createElement)(u,{id:"am-lottieplayer-height-settings",title:(0,o.__)("Height","am-lottieplayer"),value:c&&"0"!==c.toString()?c:void 0,disabled:i,onChange:e=>n({height:e}),placeholder:"auto"})),("full"===r||"wide"===r)&&(0,t.createElement)(s,{id:"am-lottieplayer-fullscreen-settings",title:(0,o.__)("Fill screen","am-lottieplayer"),value:i,onChange:e=>n({fullscreen:e})}),(0,t.createElement)(a.SelectControl,{label:(0,o.__)("Object fit"),value:d,onChange:e=>{n({objectFit:e})},options:[{value:"contain",label:(0,o.__)("Contain","am-lottieplayer")},{value:"cover",label:(0,o.__)("Cover","am-lottieplayer")},{value:"fill",label:(0,o.__)("Fill","am-lottieplayer")},{value:"none",label:(0,o.__)("None","am-lottieplayer")}]})))};function h(e){let{attributes:a,className:o,clientId:r,context:i,isSelected:c,setAttributes:s}=e;return(0,t.createElement)(l.InspectorControls,null,(0,t.createElement)(m,{attributes:a,setAttributes:s,clientId:r,isSelected:c,context:i,className:o}),(0,t.createElement)(y,{attributes:a,setAttributes:s,clientId:r,isSelected:c,context:i,className:o}),(0,t.createElement)(b,{attributes:a,setAttributes:s,clientId:r,isSelected:c,context:i,className:o}),(0,t.createElement)(p,{attributes:a,setAttributes:s,clientId:r,isSelected:c,context:i,className:o}),(0,t.createElement)(n,{attributes:a,setAttributes:s,clientId:r,isSelected:c,context:i,className:o}))}function g(){return(0,t.createElement)(a.SVG,{role:"img",xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",viewBox:"0 0 80 80"},(0,t.createElement)("style",null,"\n\t\t\t\t.am-lottieplayer-path {\n\t\t\t\t\tfill: url(#a)\n\t\t\t\t}\n\t\t\t\t.block-editor-block-toolbar .am-lottieplayer-path,\n\t\t\t\t.components-panel .am-lottieplayer-path {\n\t\t\t\t\tfill: var(--wp-admin-theme-color-darker-10)\n\t\t\t\t}"),(0,t.createElement)("defs",null,(0,t.createElement)("radialGradient",{id:"a",cx:".2",cy:"1.07",r:"1.2"},(0,t.createElement)("stop",{offset:"10%"},(0,t.createElement)("animate",{attributeName:"stop-color",values:"#24708f;#e18d4c;#1f374c;#85c6e0;#24708f;",dur:"12s",repeatCount:"indefinite"})),(0,t.createElement)("stop",{offset:"90%"},(0,t.createElement)("animate",{attributeName:"stop-color",values:"#85c6e0;#24708f;#e18d4c;#1f374c;#85c6e0;",dur:"24s",repeatCount:"indefinite"})))),(0,t.createElement)(a.Path,{className:"am-lottieplayer-path",d:"M60 0H20C9 0 0 9 0 20v39.5C0 71 9 80 20 80h39.5c11 0 20.5-9 20.5-20V20C80 9 71 0 60 0zm4.9 59.7h-7.4V37.1c0-3.2.3-8.2.3-8.2h-.1s-.9 4.7-1.7 7.5l-6.8 23.3h-4l-11-30.2c-.8-2.2-2-5.8-2-5.8h-.1s-1.1 3.4-1.9 5.8L18.7 59.7H15l15-39.4h4.2l11.4 30c.3-1.4 1.2-6.1 2.4-10.2l5.6-19.8H65v39.4z"}))}function v(e){let{children:a,onSelectMedia:n,onError:r}=e;return(0,t.createElement)(l.MediaPlaceholder,{icon:(0,t.createElement)(l.BlockIcon,{icon:g}),labels:{title:(0,o.__)("AM Lottie Animation","am-lottieplayer"),instructions:(0,o.__)("Upload Lottie animations to WordPress and add them in Gutenberg.","am-lottieplayer")},onSelect:n,accept:".lottie, .json",allowedTypes:["application/json","application/zip"],onError:r},a)}const f=window.wp.data;function E(e){let{attributes:l,clientId:a}=e;const{align:o,alt:n,autoplay:r,background:i,controls:c,direction:s,height:u,loop:d,mode:m,objectFit:p,renderer:y,speed:b,src:h,width:g}=l,{getBlockIndex:v}=(0,f.useSelect)((e=>e("core/block-editor")),[]),E=v(a),_=(0,t.useRef)(null),w=(0,t.useRef)(!0),C=(0,t.useCallback)((()=>{_.current&&(_.current.reload&&_.current.reload(),setTimeout((()=>{const e=_.current?.shadowRoot?.querySelector("canvas");"svg"===y&&e?.remove()}),100))}),[y]),k=e=>e&&"number"==typeof e?`${e}px`:null;return(0,t.useEffect)((()=>{w.current||C(),w.current=!1}),[r,E,s,d,m,p,C,y,b]),(0,t.createElement)("dotlottie-player",{class:"lottie-element",autoplay:r?"":null,controls:c?"":null,description:n,direction:s,loop:d?"":null,mode:m,objectfit:p,ref:_,renderer:y,speed:b,src:h,style:{width:(S=g,"wide"===o||"full"===o?"100%":k(S)),height:k(u),backgroundColor:i,margin:"0 auto"}});var S}function _(e){let{attributes:l,clientId:o,isPlaceholder:n,setAttributes:r}=e;return(0,t.createElement)(t.Fragment,null,n?(0,t.createElement)(v,{onSelectMedia:e=>{let{id:t,url:l,alt:a}=e;if(!l)return r({src:void 0,id:void 0});r({src:l,id:t,alt:a})},onError:e=>{(e=>{(0,t.createElement)(a.Notice,{status:"error"},e)})(e)},children:void 0}):(0,t.createElement)(E,{attributes:l,clientId:o}))}function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},w.apply(this,arguments)}const C=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"gb/lottieplayer","title":"AM LottiePlayer","description":"Play Lottie animations on your WordPress website.","keywords":["animation","gif","motion","vector","SVG","Lottie","dotLottie"],"category":"media","supports":{"align":true,"anchor":true,"html":false},"textdomain":"am-lottieplayer","attributes":{"align":{"type":"string","default":"none"},"alt":{"type":"string","source":"attribute","selector":"dotlottie-player","attribute":"description","default":"","__experimentalRole":"content"},"autoplay":{"type":"boolean","source":"attribute","selector":"dotlottie-player","attribute":"autoplay"},"background":{"type":"string","default":"transparent"},"controls":{"type":"boolean","default":true,"source":"attribute","selector":"dotlottie-player","attribute":"controls"},"clickEvent":{"type":"boolean","default":false},"direction":{"type":"number","default":1},"height":{"type":"number","default":null},"hover":{"type":"boolean","default":false},"id":{"type":"string","default":null},"interactivityType":{"type":"string","default":"none"},"loop":{"type":"boolean","source":"attribute","selector":"dotlottie-player","attribute":"loop"},"mode":{"type":"string","default":"normal"},"mouseout":{"type":"string","default":"stop"},"objectFit":{"type":"string","default":"contain"},"renderer":{"type":"string","default":"svg"},"selector":{"type":"object","default":{"id":null,"exclude":false}},"speed":{"type":"number","default":1},"src":{"type":"string","default":"","source":"attribute","selector":"dotlottie-player","attribute":"src","__experimentalRole":"content"},"width":{"type":"number","default":null}},"editorScript":"file:./index.js","editorStyle":"file:./index.css"}');(0,e.registerBlockType)(C,{icon:g,edit:function(e){let{attributes:o,className:n,clientId:i,context:c,isSelected:s,setAttributes:u}=e;const{id:d,src:m}=o,[p,y]=(0,t.useState)(!0),b=((e,t)=>!e&&(0,r.isBlobURL)(t))(d,m);return(0,t.useEffect)((()=>{y(!m||""===m)}),[m]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(h,{attributes:o,setAttributes:u,clientId:i,isSelected:s,context:c,className:n}),b&&(0,t.createElement)(a.Spinner,null),(0,t.createElement)("div",(0,l.useBlockProps)(),(0,t.createElement)(_,{attributes:o,setAttributes:u,isPlaceholder:p,clientId:i,isSelected:s,context:c,className:n})))},save:function(e){let{attributes:a}=e;const{align:o,alt:n,autoplay:r,background:i,controls:c,clickEvent:s,direction:u,height:d,hover:m,id:p,loop:y,mode:b,mouseout:h,objectFit:g,renderer:v,selector:f,speed:E,src:_,width:C}=a,k=JSON.stringify(f);return(0,t.createElement)("figure",w({id:p},l.useBlockProps.save({className:`align${o}`}),{style:{backgroundColor:i,height:d&&0!==d?d:"auto",width:C&&0!==C?C:"auto",margin:"0 auto"}}),(0,t.createElement)("dotlottie-player",{class:"lottie-element "+(f?.id?"has-selector":""),autoplay:r,controls:c,description:n,direction:u,"data-direction":u,"data-mouseover":m,"data-mouseout":h,"data-click":s,"data-selector":k,loop:y,mode:b,objectfit:g,renderer:v,src:_,speed:E}))}})})();